<% if (@activity.errors.empty?) %>

  var updateMarkerWithInfoWindow = function() {

    // change infowindow to the new marker
    var updateMarker = findMarker(<%= @activity.id %>);
    var showUpdatedInfoWindow = function() {
      openInfoWindow(
        "<%= j(render :template => 'activities/show.html.erb',
                      :locals => { :activity => @activity }) %>",
        updateMarker);
    }

    showUpdatedInfoWindow();

    // update listener for the updated marker
    updateMarker.addListener('click', function() {
      showUpdatedInfoWindow();
  });

    // update sidebar
    updateActivitySide(updateMarker.type);
}

  updateMarkerWithInfoWindow();

<% else %>

  alert("error in here");

<% end %>
